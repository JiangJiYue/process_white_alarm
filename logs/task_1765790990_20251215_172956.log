2025-12-15 17:29:56,291 [INFO] [task_1765790990] 开始处理任务 task_1765790990
[task_1] 2025-12-15 17:29:56,291 [DEBUG] 开始处理第1行数据
[task_1] 2025-12-15 17:29:56,292 [DEBUG] 最终拼接的输入文本: '事件摘要 rlike "进程(/usr/sbin/cupsd|C:\\\\Program\\sFiles\\s\\(x86\\)\\\\Matrikon\\\\ProcessSuite\\\\ProcessDoctor\\\\wlink.exe|C:\\\\WINDOWS\\\\system32\\\\cmd.exe)\\s对\\s+(c:\\\\windows\\\\microsoft.net\\\\framework\\\\v\\d.\\d.\\d+\\\\temporary\\sasp.net\\sfiles\\\\(mes\\d+_webui_mv_[a-zA-Z0-9]{2}|[a-zA-Z0-9]+)\\\\[a-zA-Z0-9]+\\\\[a-zA-Z0-9]+\\\\assembly\\\\tmp\\\\[a-zA-Z0-9]+\\\\(mes.common.[a-zA-Z0-9]+.service.dll|reportdesigner.model.dll)|/etc/cups/subscriptions.conf.O|c:\\\\programdata\\\\matrikon\\\\processsuite\\\\processdoctor\\\\pdextlib\\\\[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9]+.dll)\\s+进行\\s危险(文件写|命令执行)\\s操作。来源：系统堡垒锁.cmd:"'
[task_1] 2025-12-15 17:29:56,292 [DEBUG] {'event': 'ollama_input', 'input': '请从以下安全告警内容中提取所有程序路径、文件名，并分类输出：\n事件摘要 rlike "进程(/usr/sbin/cupsd|C:\\\\Program\\sFiles\\s\\(x86\\)\\\\Matrikon\\\\ProcessSuite\\\\ProcessDoctor\\\\wlink.exe|C:\\\\WINDOWS\\\\system32\\\\cmd.exe)\\s对\\s+(c:\\\\windows\\\\microsoft.net\\\\framework\\\\v\\d.\\d.\\d+\\\\temporary\\sasp.net\\sfiles\\\\(mes\\d+_webui_mv_[a-zA-Z0-9]{2}|[a-zA-Z0-9]+)\\\\[a-zA-Z0-9]+\\\\[a-zA-Z0-9]+\\\\assembly\\\\tmp\\\\[a-zA-Z0-9]+\\\\(mes.common.[a-zA-Z0-9]+.service.dll|reportdesigner.model.dll)|/etc/cups/subscriptions.conf.O|c:\\\\programdata\\\\matrikon\\\\processsuite\\\\processdoctor\\\\pdextlib\\\\[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9]+.dll)\\s+进行\\s危险(文件写|命令执行)\\s操作。来源：系统堡垒锁.cmd:"'}
[task_1] 2025-12-15 17:29:56,292 [INFO] 调用 Ollama 模型（第 1 次尝试）
[task_1] 2025-12-15 17:30:22,512 [DEBUG] [原始模型响应]: '[{"path":"/usr/sbin/cupsd","filename":"cupsd","type":"Web服务","app":"CUPS"},{"path":"C:\\\\Program Files (x86)\\\\Matrikon\\\\ProcessSuite\\\\ProcessDoctor\\\\wlink.exe","filename":"wlink.exe","type":"第三方软件","app":"Matrikon"},{"path":"C:\\\\WINDOWS\\\\system32\\\\cmd.exe","filename":"cmd.exe","type":"系统命令","app":"cmd"},{"path":"c:\\\\windows\\\\microsoft.net\\\\framework\\\\v4.0.30319\\\\temporary asp.net files\\\\mes1_webui_mv_abc\\\\abc\\\\abc\\\\assembly\\\\tmp\\\\abc\\\\mes.common.xyz.service.dll","filename":"mes.common.xyz.service.dll","type":"组件文件","app":"mes.common.xyz.service.dll"},{"path":"/etc/cups/subscriptions.conf.O","filename":"subscriptions.conf.O","type":"日志与临时文件","app":"<无>"},{"path":"c:\\\\programdata\\\\matrikon\\\\processsuite\\\\processdoctor\\\\pdextlib\\\\abc_def_ghi_jkl_mno.dll","filename":"abc_def_ghi_jkl_mno.dll","type":"组件文件","app":"<无>"}]'
[task_1] 2025-12-15 17:30:22,513 [DEBUG] [清理后响应]: '[{"path":"/usr/sbin/cupsd","filename":"cupsd","type":"Web服务","app":"CUPS"},{"path":"C:\\\\Program Files (x86)\\\\Matrikon\\\\ProcessSuite\\\\ProcessDoctor\\\\wlink.exe","filename":"wlink.exe","type":"第三方软件","app":"Matrikon"},{"path":"C:\\\\WINDOWS\\\\system32\\\\cmd.exe","filename":"cmd.exe","type":"系统命令","app":"cmd"},{"path":"c:\\\\windows\\\\microsoft.net\\\\framework\\\\v4.0.30319\\\\temporary asp.net files\\\\mes1_webui_mv_abc\\\\abc\\\\abc\\\\assembly\\\\tmp\\\\abc\\\\mes.common.xyz.service.dll","filename":"mes.common.xyz.service.dll","type":"组件文件","app":"mes.common.xyz.service.dll"},{"path":"/etc/cups/subscriptions.conf.O","filename":"subscriptions.conf.O","type":"日志与临时文件","app":"<无>"},{"path":"c:\\\\programdata\\\\matrikon\\\\processsuite\\\\processdoctor\\\\pdextlib\\\\abc_def_ghi_jkl_mno.dll","filename":"abc_def_ghi_jkl_mno.dll","type":"组件文件","app":"<无>"}]'
[task_1] 2025-12-15 17:30:22,513 [INFO] 模型调用成功，耗时: 26.22s
[task_1] 2025-12-15 17:30:22,517 [DEBUG] {'event': 'raw_model_response', 'response': '[{"path":"/usr/sbin/cupsd","filename":"cupsd","type":"Web服务","app":"CUPS"},{"path":"C:\\\\Program Files (x86)\\\\Matrikon\\\\ProcessSuite\\\\ProcessDoctor\\\\wlink.exe","filename":"wlink.exe","type":"第三方软件","app":"Matrikon"},{"path":"C:\\\\WINDOWS\\\\system32\\\\cmd.exe","filename":"cmd.exe","type":"系统命令","app":"cmd"},{"path":"c:\\\\windows\\\\microsoft.net\\\\framework\\\\v4.0.30319\\\\temporary asp.net files\\\\mes1_webui_mv_abc\\\\abc\\\\abc\\\\assembly\\\\tmp\\\\abc\\\\mes.common.xyz.service.dll","filename":"mes.common.xyz.service.dll","type":"组件文件","app":"mes.common.xyz.service.dll"},{"path":"/etc/cups/subscriptions.conf.O","filename":"subscriptions.conf.O","type":"日志与临时文件","app":"<无>"},{"path":"c:\\\\programdata\\\\matrikon\\\\processsuite\\\\processdoctor\\\\pdextlib\\\\abc_def_ghi_jkl_mno.dll","filename":"abc_def_ghi_jkl_mno.dll","type":"组件文件","app":"<无>"}]'}
[task_1] 2025-12-15 17:30:22,518 [DEBUG] {'event': 'cleaned_model_response', 'response': '[{"path":"/usr/sbin/cupsd","filename":"cupsd","type":"Web服务","app":"CUPS"},{"path":"C:\\\\Program Files (x86)\\\\Matrikon\\\\ProcessSuite\\\\ProcessDoctor\\\\wlink.exe","filename":"wlink.exe","type":"第三方软件","app":"Matrikon"},{"path":"C:\\\\WINDOWS\\\\system32\\\\cmd.exe","filename":"cmd.exe","type":"系统命令","app":"cmd"},{"path":"c:\\\\windows\\\\microsoft.net\\\\framework\\\\v4.0.30319\\\\temporary asp.net files\\\\mes1_webui_mv_abc\\\\abc\\\\abc\\\\assembly\\\\tmp\\\\abc\\\\mes.common.xyz.service.dll","filename":"mes.common.xyz.service.dll","type":"组件文件","app":"mes.common.xyz.service.dll"},{"path":"/etc/cups/subscriptions.conf.O","filename":"subscriptions.conf.O","type":"日志与临时文件","app":"<无>"},{"path":"c:\\\\programdata\\\\matrikon\\\\processsuite\\\\processdoctor\\\\pdextlib\\\\abc_def_ghi_jkl_mno.dll","filename":"abc_def_ghi_jkl_mno.dll","type":"组件文件","app":"<无>"}]'}
[task_1] 2025-12-15 17:30:22,518 [DEBUG] Ollama 处理完成，返回结果数: 6
[task_1] 2025-12-15 17:30:22,518 [DEBUG] [ollama1] 路径验证结果: '/usr/sbin/cupsd' -> 有效
[task_1] 2025-12-15 17:30:22,518 [DEBUG] [ollama2] 路径验证结果: 'C:\\Program Files (x86)\\Matrikon\\ProcessSuite\\ProcessDoctor\\wlink.exe' -> 有效
[task_1] 2025-12-15 17:30:22,518 [DEBUG] [ollama3] 路径验证结果: 'C:\\WINDOWS\\system32\\cmd.exe' -> 有效
[task_1] 2025-12-15 17:30:22,518 [DEBUG] [ollama4] 路径验证结果: 'c:\\windows\\microsoft.net\\framework\\v4.0.30319\\temporary asp.net files\\mes1_webui_mv_abc\\abc\\abc\\assembly\\tmp\\abc\\mes.common.xyz.service.dll' -> 有效
[task_1] 2025-12-15 17:30:22,518 [DEBUG] [ollama5] 路径验证结果: '/etc/cups/subscriptions.conf.O' -> 有效
[task_1] 2025-12-15 17:30:22,518 [DEBUG] [ollama6] 路径验证结果: 'c:\\programdata\\matrikon\\processsuite\\processdoctor\\pdextlib\\abc_def_ghi_jkl_mno.dll' -> 有效
[task_1] 2025-12-15 17:30:22,518 [DEBUG] 第1行数据处理完成
[task_2] 2025-12-15 17:30:22,519 [DEBUG] 开始处理第2行数据
[task_2] 2025-12-15 17:30:22,519 [DEBUG] 最终拼接的输入文本: '事件摘要 rlike "进程(C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\(v\\d.\\d.\\d+){0,1}\\\\csc.exe|/opt/opsmgr/web/components/openjdk11linux64arm.1/bin/java)\\s对\\s+(/opt/opsmgr/web/components/xmole.1/bin/xmole-agent/workspace/app/xmole-flink-policy-monitor/flink-io-cache/flink-rpc-akka_[a-zA-Z0-9]+-[a-zA-Z0-9]+-[a-zA-Z0-9]+-[a-zA-Z0-9]+-[a-zA-Z0-9]+.jar|c:\\\\users\\\\mmsh-eip2017-svc\\\\appdata\\\\local\\\\temp\\\\([a-zA-Z0-9]+\\\\){0,1}[a-zA-Z0-9]+.dll)\\s+进行\\s+危险文件写\\s操作。来源：系统堡垒锁.cmd:"'
[task_2] 2025-12-15 17:30:22,519 [DEBUG] {'event': 'ollama_input', 'input': '请从以下安全告警内容中提取所有程序路径、文件名，并分类输出：\n事件摘要 rlike "进程(C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\(v\\d.\\d.\\d+){0,1}\\\\csc.exe|/opt/opsmgr/web/components/openjdk11linux64arm.1/bin/java)\\s对\\s+(/opt/opsmgr/web/components/xmole.1/bin/xmole-agent/workspace/app/xmole-flink-policy-monitor/flink-io-cache/flink-rpc-akka_[a-zA-Z0-9]+-[a-zA-Z0-9]+-[a-zA-Z0-9]+-[a-zA-Z0-9]+-[a-zA-Z0-9]+.jar|c:\\\\users\\\\mmsh-eip2017-svc\\\\appdata\\\\local\\\\temp\\\\([a-zA-Z0-9]+\\\\){0,1}[a-zA-Z0-9]+.dll)\\s+进行\\s+危险文件写\\s操作。来源：系统堡垒锁.cmd:"'}
[task_2] 2025-12-15 17:30:22,519 [INFO] 调用 Ollama 模型（第 1 次尝试）
[task_2] 2025-12-15 17:30:33,778 [DEBUG] [原始模型响应]: '[{"path":"C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\csc.exe","filename":"csc.exe","type":"系统命令","app":"csc"},{"path":"/opt/opsmgr/web/components/openjdk11linux64arm.1/bin/java","filename":"java","type":"解释器","app":"java"},{"path":"/opt/opsmgr/web/components/xmole.1/bin/xmole-agent/workspace/app/xmole-flink-policy-monitor/flink-io-cache/flink-rpc-akka_abc123-def456-ghi789-jkl012-mno345.jar","filename":"flink-rpc-akka_abc123-def456-ghi789-jkl012-mno345.jar","type":"组件文件","app":"flink-rpc"},{"path":"C:\\\\Users\\\\mmsh-eip2017-svc\\\\AppData\\\\Local\\\\Temp\\\\tempfile.dll","filename":"tempfile.dll","type":"日志与临时文件","app":"<无>"}]'
[task_2] 2025-12-15 17:30:33,779 [DEBUG] [清理后响应]: '[{"path":"C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\csc.exe","filename":"csc.exe","type":"系统命令","app":"csc"},{"path":"/opt/opsmgr/web/components/openjdk11linux64arm.1/bin/java","filename":"java","type":"解释器","app":"java"},{"path":"/opt/opsmgr/web/components/xmole.1/bin/xmole-agent/workspace/app/xmole-flink-policy-monitor/flink-io-cache/flink-rpc-akka_abc123-def456-ghi789-jkl012-mno345.jar","filename":"flink-rpc-akka_abc123-def456-ghi789-jkl012-mno345.jar","type":"组件文件","app":"flink-rpc"},{"path":"C:\\\\Users\\\\mmsh-eip2017-svc\\\\AppData\\\\Local\\\\Temp\\\\tempfile.dll","filename":"tempfile.dll","type":"日志与临时文件","app":"<无>"}]'
[task_2] 2025-12-15 17:30:33,779 [INFO] 模型调用成功，耗时: 11.26s
[task_2] 2025-12-15 17:30:33,784 [DEBUG] {'event': 'raw_model_response', 'response': '[{"path":"C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\csc.exe","filename":"csc.exe","type":"系统命令","app":"csc"},{"path":"/opt/opsmgr/web/components/openjdk11linux64arm.1/bin/java","filename":"java","type":"解释器","app":"java"},{"path":"/opt/opsmgr/web/components/xmole.1/bin/xmole-agent/workspace/app/xmole-flink-policy-monitor/flink-io-cache/flink-rpc-akka_abc123-def456-ghi789-jkl012-mno345.jar","filename":"flink-rpc-akka_abc123-def456-ghi789-jkl012-mno345.jar","type":"组件文件","app":"flink-rpc"},{"path":"C:\\\\Users\\\\mmsh-eip2017-svc\\\\AppData\\\\Local\\\\Temp\\\\tempfile.dll","filename":"tempfile.dll","type":"日志与临时文件","app":"<无>"}]'}
[task_2] 2025-12-15 17:30:33,784 [DEBUG] {'event': 'cleaned_model_response', 'response': '[{"path":"C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\csc.exe","filename":"csc.exe","type":"系统命令","app":"csc"},{"path":"/opt/opsmgr/web/components/openjdk11linux64arm.1/bin/java","filename":"java","type":"解释器","app":"java"},{"path":"/opt/opsmgr/web/components/xmole.1/bin/xmole-agent/workspace/app/xmole-flink-policy-monitor/flink-io-cache/flink-rpc-akka_abc123-def456-ghi789-jkl012-mno345.jar","filename":"flink-rpc-akka_abc123-def456-ghi789-jkl012-mno345.jar","type":"组件文件","app":"flink-rpc"},{"path":"C:\\\\Users\\\\mmsh-eip2017-svc\\\\AppData\\\\Local\\\\Temp\\\\tempfile.dll","filename":"tempfile.dll","type":"日志与临时文件","app":"<无>"}]'}
[task_2] 2025-12-15 17:30:33,784 [DEBUG] Ollama 处理完成，返回结果数: 4
[task_2] 2025-12-15 17:30:33,784 [DEBUG] [ollama1] 路径验证结果: 'C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe' -> 有效
[task_2] 2025-12-15 17:30:33,784 [DEBUG] [ollama2] 路径验证结果: '/opt/opsmgr/web/components/openjdk11linux64arm.1/bin/java' -> 有效
[task_2] 2025-12-15 17:30:33,784 [DEBUG] [ollama3] 路径验证结果: '/opt/opsmgr/web/components/xmole.1/bin/xmole-agent/workspace/app/xmole-flink-policy-monitor/flink-io-cache/flink-rpc-akka_abc123-def456-ghi789-jkl012-mno345.jar' -> 有效
[task_2] 2025-12-15 17:30:33,785 [DEBUG] [ollama4] 路径验证结果: 'C:\\Users\\mmsh-eip2017-svc\\AppData\\Local\\Temp\\tempfile.dll' -> 有效
[task_2] 2025-12-15 17:30:33,785 [DEBUG] 第2行数据处理完成
[task_3] 2025-12-15 17:30:33,785 [DEBUG] 开始处理第3行数据
[task_3] 2025-12-15 17:30:33,786 [DEBUG] 最终拼接的输入文本: '事件摘要 rlike "进程(C:\\\\(Windows|WINDOWS)\\\\(System32|SysWOW64|system32)\\\\inetsrv\\\\w3wp.exe)\\s对\\s+(c:\\\\windows\\\\microsoft.net\\\\framework\\\\v\\d.\\d.\\d+\\\\temporary\\sasp.net\\sfiles\\\\((mes30_(webui|webservice)_([a-zA-Z0-9]){2}_([a-zA-Z0-9]{2,4}))|[a-zA-Z0-9]+)\\\\[a-zA-Z0-9]+\\\\[a-zA-Z0-9]+\\\\assembly\\\\tmp\\\\[a-zA-Z0-9]+\\\\(antlr(\\d){0,1}.runtime|app_licenses|app_web_([a-zA-Z0-9]+.aspx.){0,1}[a-zA-Z0-9]+|mes.common.[a-zA-Z0-9]+.[a-zA-Z0-9]+|microsoft.owin.[a-zA-Z0-9]+|mes.business.[a-zA-Z0-9]+.[a-zA-Z0-9]+.[a-zA-Z0-9]+.[a-zA-Z0-9]+|entityframework|framework.common|h3engine|h3entity|microsoft.aspnet.identity.core|microsoft.owin.host.systemweb|tpiyearinfo).dll|c:\\\\users\\\\mmsh-eip2017-svc\\\\appdata\\\\local\\\\temp\\\\([a-zA-Z0-9]+\\\\){0,1}[a-zA-Z0-9]+.dll|c:\\\\windows\\\\temp\\\\[a-zA-Z0-9]+.dll)\\s+进行\\s+危险文件写\\s操作。来源：系统堡垒锁.cmd:"'
[task_3] 2025-12-15 17:30:33,786 [DEBUG] {'event': 'ollama_input', 'input': '请从以下安全告警内容中提取所有程序路径、文件名，并分类输出：\n事件摘要 rlike "进程(C:\\\\(Windows|WINDOWS)\\\\(System32|SysWOW64|system32)\\\\inetsrv\\\\w3wp.exe)\\s对\\s+(c:\\\\windows\\\\microsoft.net\\\\framework\\\\v\\d.\\d.\\d+\\\\temporary\\sasp.net\\sfiles\\\\((mes30_(webui|webservice)_([a-zA-Z0-9]){2}_([a-zA-Z0-9]{2,4}))|[a-zA-Z0-9]+)\\\\[a-zA-Z0-9]+\\\\[a-zA-Z0-9]+\\\\assembly\\\\tmp\\\\[a-zA-Z0-9]+\\\\(antlr(\\d){0,1}.runtime|app_licenses|app_web_([a-zA-Z0-9]+.aspx.){0,1}[a-zA-Z0-9]+|mes.common.[a-zA-Z0-9]+.[a-zA-Z0-9]+|microsoft.owin.[a-zA-Z0-9]+|mes.business.[a-zA-Z0-9]+.[a-zA-Z0-9]+.[a-zA-Z0-9]+.[a-zA-Z0-9]+|entityframework|framework.common|h3engine|h3entity|microsoft.aspnet.identity.core|microsoft.owin.host.systemweb|tpiyearinfo).dll|c:\\\\users\\\\mmsh-eip2017-svc\\\\appdata\\\\local\\\\temp\\\\([a-zA-Z0-9]+\\\\){0,1}[a-zA-Z0-9]+.dll|c:\\\\windows\\\\temp\\\\[a-zA-Z0-9]+.dll)\\s+进行\\s+危险文件写\\s操作。来源：系统堡垒锁.cmd:"'}
[task_3] 2025-12-15 17:30:33,786 [INFO] 调用 Ollama 模型（第 1 次尝试）
